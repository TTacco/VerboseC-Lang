import TokenLibrary.Token;
import TokenLibrary.TokenDataType;
import TokenLibrary.TokenTypes;
import com.sun.xml.internal.bind.v2.TODO;

import java.util.Dictionary;
import java.util.HashMap;
import java.util.Stack;

public class Parser {
    Scanner scan;

    HashMap<String, ReductionRule> rules = new HashMap<>();


    String gotoTable[][] = {
            	{"1","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","5","6","7","8","9","10","23","11","16","17","12","18","21","24","26","27","28","22","","25"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","37","7","8","9","10","23","11","16","17","12","18","21","24","26","27","28","22","","25"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","51","","","","","48","49","52","54","55","56","50","","53"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","51","","","","","68","49","52","54","55","56","50","","53"},
            	{"","","","","","","108","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","73","24","26","27","28","","","25"},
            	{"","","","","","","","","","","","","","","74","26","27","28","","","25"},
            	{"","","","","","","","","","","","","","","","75","27","28","","","25"},
            	{"","","","","","","","","","","","","","","","","76","28","","","25"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","51","","","","","97","49","52","54","55","56","50","","53"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","","101"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","","110"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","111","52","54","55","56","","","53"},
            	{"","","","","","","","","","","","","","","112","54","55","56","","","53"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","118","55","56","","","53"},
            	{"","","","","","","","","","","","","","","","","124","56","","","53"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","","131"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","23","","","","","138","21","24","26","27","28","22","","25"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","141","7","8","9","10","23","11","16","17","12","18","21","24","26","27","28","22","","25"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","","143"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","145","146","147","148","23","149","154","155","150","156","21","24","26","27","28","22","","25"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","51","","","","","170","49","52","54","55","56","50","","53"},
            	{"","","","","","","177","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","51","","","","","174","49","52","54","55","56","50","","53"},
            	{"","","175","7","8","9","10","23","11","16","17","12","18","21","24","26","27","28","22","","25"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","","178"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","23","","","","","182","21","24","26","27","28","22","","25"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","185","7","8","9","10","23","11","16","17","12","18","21","24","26","27","28","22","","25"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","187","7","8","9","10","23","11","16","17","12","18","21","24","26","27","28","22","","25"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","189","146","147","148","23","149","154","155","150","156","21","24","26","27","28","22","","25"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","51","","","","","195","49","52","54","55","56","50","","53"},
            	{"","","196","7","8","9","10","23","11","16","17","12","18","21","24","26","27","28","22","","25"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","200","7","8","9","10","23","11","16","17","12","18","21","24","26","27","28","22","","25"},
            	{"","","","","","","","","","","","","","","","","","","","",""},
            	{"","","","","","","","","","","","","","","","","","","","",""},

    };


    String parseTable[][] = {
            {"S2","","","","","","","","","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","","","","","","","","","","","","","","","Accept"},
            {"","S3","","","","","","","","","","","","","","","","","","","","","","","",""},
            {"","","","S4","","","","","","","","","","","","","","","","","","","","","",""},
            {"","","S30","","R3","","S13","S29","","","S14","","","S19","S34","S20","","","","","S31","S32","S33","S35","S15"},
            {"","","","","S36","","","","","","","","","","","","","","","","","","","","",""},
            {"","","","","R2","","","","","","","","","","","","","","","","","","","","",""},
            {"","","S30","","R4","","S13","S29","","","S14","","","S19","S34","S20","","","","","S31","S32","S33","S35","S15"},
            {"","","R6","","R6","","R6","R6","","","R6","","","R6","R6","R6","","","","","R6","R6","R6","R6","R6",""},
            {"","","R7","","R7","","R7","R7","","","R7","","","R7","R7","R7","","","","","R7","R7","R7","R7","R7",""},
            {"","","R8","","R8","","R8","R8","","","R8","","","R8","R8","R8","","","","","R8","R8","R8","R8","R8",""},
            {"","","R9","","R9","","R9","R9","","","R9","","","R9","R9","R9","","","","","R9","R9","R9","R9","R9",""},
            {"","","R10","","R10","","R10","R10","","","R10","","","R10","R10","R10","","","","","R10","R10","R10","R10","R10",""},
            {"","","","","","","","S38","","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","S39","","","","","","","","","","","","","","","","","",""},
            {"","","S40","","","","","","","","","","","","","","","","","","","","","","",""},
            {"","","R15","","R15","","R15","R15","","","R15","","","R15","R15","R15","","","","","R15","R15","R15","R15","R15",""},
            {"","","R16","","R16","","R16","R16","","","R16","","","R16","R16","R16","","","","","R16","R16","R16","R16","R16",""},
            {"","","","","","","","","","","","S41","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","","","","S42","","","","","","","","","","",""},
            {"","","","","","","","","","","","S43","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R20","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R21","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R22","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R24","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R33","","","","","S44","S45","S46","S47","","","","","",""},
            {"","","","","","","","","","","","R26","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R28","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R30","","","","","","","","","","","","","",""},
            {"","","S58","","","","","S57","","","","","","","S61","","","","","","S63","S59","S60","S62","",""},
            {"","","","","","","","","","","","R36","S65","","","","R36","R36","R36","R36","S64","","","","",""},
            {"","","S66","","","","","","","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R37","","","","","R37","R37","R37","R37","","","","","",""},
            {"","","","","","","","","","","","R38","","","","","R38","R38","R38","R38","","","","","",""},
            {"","","","","","","","","","","","R39","","","","","R39","R39","R39","R39","","","","","",""},
            {"","","","","","","","","","","","R37","","","","","R40","R40","R40","R40","","","","","",""},
            {"","","","","","S67","","","","","","","","","","","","","","","","","","","",""},
            {"","","","","R5","","","","","","","","","","","","","","","","","","","","",""},
            {"","","S58","","","","","S57","","","","","","","S61","","","","","","S63","S59","S60","S62","",""},
            {"","","","","","","","","","","","","","","","","","","","","","","","","S70",""},
            {"","","","","","","","","","","","","S71","","","","","","","","","","","","",""},
            {"","","R19","","R19","","R19","R19","","","R19","","","R19","R19","R19","","","","","R19","R19","R19","R19","R19",""},
            {"","","","","","","","","","","","S72","","","","","","","","","","","","","",""},
            {"","","R18","","R18","","R18","R18","","","R18","","","R18","R18","R18","","","","","R18","R18","R18","R18","R18",""},
            {"","","S30","","","","","S29","","","","","","","S34","","","","","","","S32","S33","S35","",""},
            {"","","S80","","","","","S29","","","","","","","S83","","","","","","","S81","S82","S84","",""},
            {"","","S85","","","","","S29","","","","","","","S88","","","","","","","S86","S87","S89","",""},
            {"","","S90","","","","","S29","","","","","","","S93","","","","","","","S91","S92","S94","",""},
            {"","","","","","","","","S77","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R20","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R21","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R22","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R24","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R33","","","","","","","","S78","S79","S95","S96","","","","","",""},
            {"","","","","","","","","R26","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R28","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R30","","","","","","","","","","","","","","","","",""},
            {"","","S58","","","","","S57","","","","","","","S61","","","","","","S63","S59","S60","S62","",""},
            {"","","","","","","","","R36","","","","S99","","","","R36","R36","R36","R36","S98","","","","",""},
            {"","","","","","","","","R37","","","","","","","","R37","R37","R37","R37","","","","","",""},
            {"","","","","","","","","R38","","","","","","","","R38","R38","R38","R38","","","","","",""},
            {"","","","","","","","","R39","","","","","","","","R39","R39","R39","R39","","","","","",""},
            {"","","","","","","","","R40","","","","","","","","R40","R40","R40","R40","","","","","",""},
            {"","","S100","","","","","","","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R34","","","","","","","","","","","","","",""},
            {"","","S102","","","","","","","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R35","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","","","","","","","","","","","","","","","R1"},
            {"","","","","","","","","S107","","","","","","","","","","","","","","","","",""},
            {"","","S109","","","","","","","","","","","","","","","","","","","","","","",""},
            {"","","S102","","","","","","","","","","","","S105","","","","","","","S103","S104","S106","",""},
            {"","","R17","","R17","","R17","R17","","","R17","","","R17","R17","R17","","","","","R17","R17","R17","R17","R17",""},
            {"","","","","","","","","","","","R25","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R27","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R29","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R31","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R32","","","","","","","","","","","","","",""},
            {"","","S58","","","","","S57","","","","","","","S61","","","","","","","S59","S60","S62","",""},
            {"","","S113","","","","","S57","","","","","","","S116","","","","","","","S114","S115","S117","",""},
            {"","","","","","","","","","","","R36","","","","","","R36","R36","R36","","","","","",""},
            {"","","","","","","","","","","","R37","","","","","","R37","R37","R37","","","","","",""},
            {"","","","","","","","","","","","R38","","","","","","R38","R38","R38","","","","","",""},
            {"","","","","","","","","","","","R39","","","","","","R39","R39","R39","","","","","",""},
            {"","","","","","","","","","","","R40","","","","","","R40","R40","R40","","","","","",""},
            {"","","","","","","","","","","","R36","","","","","","","R36","R36","","","","","",""},
            {"","","","","","","","","","","","R37","","","","","","","R37","R37","","","","","",""},
            {"","","","","","","","","","","","R38","","","","","","","R38","R38","","","","","",""},
            {"","","","","","","","","","","","R39","","","","","","","R39","R39","","","","","",""},
            {"","","","","","","","","","","","R40","","","","","","","R40","R40","","","","","",""},
            {"","","","","","","","","","","","R36","","","","","","","","R36","","","","","",""},
            {"","","","","","","","","","","","R37","","","","","","","","R37","","","","","",""},
            {"","","","","","","","","","","","R38","","","","","","","","R38","","","","","",""},
            {"","","","","","","","","","","","R39","","","","","","","","R39","","","","","",""},
            {"","","","","","","","","","","","R40","","","","","","","","R40","","","","","",""},
            {"","","S119","","","","","S57","","","","","","","S122","","","","","","","S120","S121","S123","",""},
            {"","","S125","","","","","S57","","","","","","","S128","","","","","","","S126","S127","S129","",""},
            {"","","","","","","","","S130","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R34","","","","","","","","","","","","","","","","",""},
            {"","","S132","","","","","","","","","","","","S135","","","","","","","S133","S134","S136","",""},
            {"","","","","","","","","R35","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R23","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R36","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R37","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R38","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R39","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","R40","","","","","","","","","","","","","",""},
            {"","","","S137","","","","","","","","","","","","","","","","R39","","","","","",""},
            {"","","S30","","","","","S29","","","","","","","S34","","","","","","S31","S32","S33","S35","",""},
            {"","","","","","","","","","","","","S139","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","S140","","","","","","","","","","","","","",""},
            {"","","","","","","","","R25","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R27","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R36","","","","","","","","","R36","R36","R36","","","","","",""},
            {"","","","","","","","","R37","","","","","","","","","R37","R37","R37","","","","","",""},
            {"","","","","","","","","R38","","","","","","","","","R38","R38","R38","","","","","",""},
            {"","","","","","","","","R39","","","","","","","","","R39","R39","R39","","","","","",""},
            {"","","","","","","","","R40","","","","","","","","","R40","R40","R40","","","","","",""},
            {"","","","","","","","","R29","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R36","","","","","","","","","","R36","R36","","","","","",""},
            {"","","","","","","","","R37","","","","","","","","","","R37","R37","","","","","",""},
            {"","","","","","","","","R38","","","","","","","","","","R38","R38","","","","","",""},
            {"","","","","","","","","R39","","","","","","","","","","R39","R39","","","","","",""},
            {"","","","","","","","","R40","","","","","","","","","","R40","R40","","","","","",""},
            {"","","","","","","","","R31","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R36","","","","","","","","","","","R36","","","","","",""},
            {"","","","","","","","","R37","","","","","","","","","","","R37","","","","","",""},
            {"","","","","","","","","R38","","","","","","","","","","","R38","","","","","",""},
            {"","","","","","","","","R39","","","","","","","","","","","R39","","","","","",""},
            {"","","","","","","","","R40","","","","","","","","","","","R40","","","","","",""},
            {"","","","","","","","","R32","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R23","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R36","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R37","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R38","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R39","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R40","","","","","","","","","","","","","","","","",""},
            {"","","S30","","","","S13","S29","","","S14","","","S19","S34","S20","","","","","S31","S32","S33","S35","S15"},
            {"","","","","","","","","","","","S142","","","","","","","","","","","","","",""},
            {"","","S102","","","","","","","","","","","","S105","","","","","","","S103","S104","S106","",""},
            {"","","R14","","R14","","R14","R14","","","R14","","","R14","R14","R14","","","","","R14","R14","R14","R14","R14",""},
            {"","","","","S144","","","","","","","","","","","","","","","","","","","","",""},
            {"","","S30","","","","S151","S29","","","S152","","","S157","S34","S158","","","","","S31","S32","S33","S35","S153",""},
            {"","","","","","","","","","","","S159","","","","","","","","","","","","","",""},
            {"","","R11","","R11","","R11","R11","","S160","R11","","","R11","R11","R11","","","","","R11","R11","R11","R11","R11",""},
            {"","","","","","","","","S161","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R6","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R7","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R8","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R9","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R10","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","S162","","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","S163","","","","","","","","","","","","","","","","","",""},
            {"","","S164","","","","","","","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R15","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R16","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","S165","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","","","","S166","","","","","","","","","","",""},
            {"","","","","","","","","","","","S167","","","","","","","","","","","","","",""},
            {"","","R14","","","","","R14","","","","","","","R14","","","","","","R14","R14","R14","R14","",""},
            {"","","","","","","","S168","","","","","","","","","","","","","","","","","",""},
            {"","","","S169","","","","","","","","","","","","","","","","","","","","","",""},
            {"","","S58","","","","","S57","","","","","","","S61","","","","","","S63","S59","S60","S62","",""},
            {"","","","","","","","","","","","","","","","","","","","","","","","","S70",""},
            {"","","","","","","","","","","","","S172","","","","","","","","","","","","",""},
            {"","","","","","","","","R19","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","","","","S173","","","","","","","","","","","","","",""},
            {"","","","","","","","","R18","","","","","","","","","","","","","","","","",""},
            {"","","S58","","","","","S57","","","","","","","S61","","","","","","S63","S59","S60","S62","",""},
            {"","","S30","","","","S13","S29","","","S14","","","S19","S34","S20","","","","","S31","S32","S33","S35","S15",""},
            {"","","","","","","","","S176","","","","","","","","","","","","","","","","",""},
            {"","","S102","","","","","","","","","","","","S105","","","","","","","S103","S104","S106","",""},
            {"","","","","","","","","R17","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","S179","","","","","","","","","","","","","","","","",""},
            {"","","","","S180","","","","","","","","","","","","","","","","","","","","",""},
            {"","","","S181","","","","","","","","","","","","","","","","","","","","","",""},
            {"","","S30","","","","","S29","","","","","","","S34","","","","","","S31","S32","S33","S35","",""},
            {"","","","","","","","","","","","S183","","","","","","","","","","","","","",""},
            {"","","","S184","","","","","","","","","","","","","","","","","","","","","",""},
            {"","","R13","","R13","","R13","R13","","","R13","","","R13","R13","R13","","","","","R13","R13","R13","R13","R13",""},
            {"","","S30","","","","S13","S29","","","S14","","","S19","S34","S20","","","","","S31","S32","S33","S35","S15",""},
            {"","","","","","","","","","","","S186","","","","","","","","","","","","","",""},
            {"","","","","","","","","R14","","","","","","","","","","","","","","","","",""},
            {"","","S30","","","","S13","S29","","","S14","","","S19","S34","S20","","","","","S31","S32","S33","S35","S15",""},
            {"","","","","S188","","","","","","","","","","","","","","","","","","","","",""},
            {"","","S30","","","","S151","S29","","","S152","","","S157","S34","S158","","","","","S31","S32","S33","S35","S153",""},
            {"","","","","S190","","","","","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R11","S191","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","S192","","","","","","","","","","","","","","","","",""},
            {"","","R12","","R12","","R12","R12","","","R12","","","R12","R12","R12","","","","","R12","R12","R12","R12","R12",""},
            {"","","","","","","","S193","","","","","","","","","","","","","","","","","",""},
            {"","","","S194","","","","","","","","","","","","","","","","","","","","","",""},
            {"","","S58","","","","","S57","","","","","","","S61","","","","","","S63","S59","S60","S62","",""},
            {"","","S30","","","","S13","S29","","","S14","","","S19","S34","S20","","","","","S31","S32","S33","S35","S15",""},
            {"","","","","","","","","S197","","","","","","","","","","","","","","","","",""},
            {"","","","","S198","","","","","","","","","","","","","","","","","","","","",""},
            {"","","","S199","","","","","","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R13","","","","","","","","","","","","","","","","",""},
            {"","","S30","","","","S13","S29","","","S14","","","S19","S34","S20","","","","","S31","S32","S33","S35","S15",""},
            {"","","","","S201","","","","","","","","","","","","","","","","","","","","",""},
            {"","","","","","","","","R12","","","","","","","","","","","","","","","","",""},
                    };

    public Parser(Scanner scan){
        this.scan = scan;

        rules.put("R1", new ReductionRule(TokenTypes.VAR_KEYWORDBEGIN, 6, "<Keyword Begin> := BEGIN_PROGRAM PROGRAM_NAME BLOCKSTART <Program Body> BLOCKEND END_PROGRAM"));

        rules.put("R2", new ReductionRule(TokenTypes.VAR_PROGRAMBODY, 1, "<Program Body> :=  <Statements>"));
        rules.put("R3", new ReductionRule(TokenTypes.VAR_PROGRAMBODY, 0, "<Program Body> :=  Îµ"));

        rules.put("R4", new ReductionRule(TokenTypes.VAR_STATEMENTS, 1, "<Statements> := <Statement>"));
        rules.put("R5", new ReductionRule(TokenTypes.VAR_STATEMENTS, 2, "<Statements> := <Statement> <Statements>"));

        rules.put("R6", new ReductionRule(TokenTypes.VAR_STATEMENT, 1, "<Statement> := <Conditional-Statement>"));
        rules.put("R7", new ReductionRule(TokenTypes.VAR_STATEMENT, 1, "<Statement> := <Repeat-Statement>"));
        rules.put("R8", new ReductionRule(TokenTypes.VAR_STATEMENT, 1, "<Statement> := <Variable-Declaration> "));
        rules.put("R9", new ReductionRule(TokenTypes.VAR_STATEMENT, 1, "<Statement> := <IO-Statement>"));
        rules.put("R10", new ReductionRule(TokenTypes.VAR_STATEMENT, 1,"<Statement> := <Expression-Statement>"));

        rules.put("R11", new ReductionRule(TokenTypes.VAR_CONDITIONALSTATEMENT, 7, "<Conditional-Statement> := COND_CONSIDER LBRACKET <Expression> RBRACKET BLOCKSTART <Statements> BLOCKEND"));
        rules.put("R12", new ReductionRule(TokenTypes.VAR_CONDITIONALSTATEMENT, 14, "<Conditional-Statement> := COND_CONSIDER  LBRACKET <Expression> RBRACKET BLOCKSTART <Statements> BLOCKEND COND_OTHERW LBRACKET <Expression> RBRACKET BLOCKSTART <Statements> BLOCKEND"));

        rules.put("R13", new ReductionRule(TokenTypes.VAR_REPEATSTATEMENT, 11, "<Repeat-Statement> := LOOP_REPEAT LBRACKET <Variable-Declaration> ENDLINE <Expression> ENDLINE <Statement> RBRACKET BLOCKSTART <Statements> BLOCKEND"));

        rules.put("R14", new ReductionRule(TokenTypes.VAR_VARIABLEDECLARATION, 5, "<Variable-Declaration> :=  DATA_TYPE ID ASSIGN_OP <Value> ENDLINE"));

        rules.put("R15", new ReductionRule(TokenTypes.VAR_IOSTATEMENT, 1, "<IO-Statement> := <Say-Statement>"));
        rules.put("R16", new ReductionRule(TokenTypes.VAR_IOSTATEMENT, 1, "<IO-Statement> := <Listen-Statement> "));

        rules.put("R17", new ReductionRule(TokenTypes.VAR_SAYSTATEMENT, 3, "<Say-Statement> := SET_SAY  STRINGLITERAL  ENDLINE"));
        rules.put("R18", new ReductionRule(TokenTypes.VAR_LISTENSTATEMENT, 2, "<Listen-Statement> := GET_LISTEN  ENDLINE"));

        rules.put("R19", new ReductionRule(TokenTypes.VAR_EXPRESSIONSTATEMENT, 2, "<Expression-Statement> := <Expression> ENDLINE"));

        rules.put("R20", new ReductionRule(TokenTypes.VAR_EXPRESSION, 1, "<Expression> := <Logical-Expression>"));
        rules.put("R21", new ReductionRule(TokenTypes.VAR_EXPRESSION, 1, "<Expression> := <Unary-Expression>"));
        rules.put("R22", new ReductionRule(TokenTypes.VAR_EXPRESSION, 1, "<Expression> := <Assignment-Expression>"));

        rules.put("R23", new ReductionRule(TokenTypes.VAR_ASSIGNMENTEXPRESSION, 3, "<Assignment-Expression> := ID  ASSIGN_OP <Value>"));

        rules.put("R24", new ReductionRule(TokenTypes.VAR_LOGICALEXPRESSION, 1, "<Logical-Expression> := <Relational-Expression> "));
        rules.put("R25", new ReductionRule(TokenTypes.VAR_LOGICALEXPRESSION, 3, "<Logical-Expression> := <Value>  LOGICALOP <Logical-Expression>"));

        rules.put("R26", new ReductionRule(TokenTypes.VAR_RELATIONALEXPRESSION, 1, "<Relational-Expression> := <AddSub-Expression> "));
        rules.put("R27", new ReductionRule(TokenTypes.VAR_RELATIONALEXPRESSION, 3, "<Relational-Expression> := <Value>  RELOP <Relational-Expression>"));

        rules.put("R28", new ReductionRule(TokenTypes.VAR_ADDSUBEXPRESSION, 1, "<AddSub-Expression> := <Muldiv-Expression> "));
        rules.put("R29", new ReductionRule(TokenTypes.VAR_ADDSUBEXPRESSION, 3, "<AddSub-Expression> := <Value>  ADDSUB_AROP <AddSub-Expression>"));

        rules.put("R30", new ReductionRule(TokenTypes.VAR_MULDIVEXPRESSION, 1, "<MulDiv-Expression> := <Nested-Expression> "));
        rules.put("R31", new ReductionRule(TokenTypes.VAR_MULDIVEXPRESSION, 3, "<MulDiv-Expression> := <Value>  MULDIV_AROP <MulDiv-Expression>"));

        rules.put("R32", new ReductionRule(TokenTypes.VAR_NESTEDEXPRESSION, 3, "<Nested-Expression> := LBRACKET <Expression> RBRACKET "));
        rules.put("R33", new ReductionRule(TokenTypes.VAR_NESTEDEXPRESSION, 1, "<Nested-Expression> := <Value>"));

        rules.put("R34", new ReductionRule(TokenTypes.VAR_UNARYEXPRESSION, 1, "<Unary-Expression> := ID  INDEC_OP "));
        rules.put("R35", new ReductionRule(TokenTypes.VAR_UNARYEXPRESSION, 1, "<Unary-Expression> := INDEC_OP  ID"));

        rules.put("R36", new ReductionRule(TokenTypes.VAR_VALUE, 1, "<Value> := ID "));
        rules.put("R37", new ReductionRule(TokenTypes.VAR_VALUE, 1, "<Value> := NUMCONSTANTS"));
        rules.put("R38", new ReductionRule(TokenTypes.VAR_VALUE, 1, "<Value> := BOOLLITERAL"));
        rules.put("R39", new ReductionRule(TokenTypes.VAR_VALUE, 1, "<Value> := STRINGLITERAL "));
        rules.put("R40", new ReductionRule(TokenTypes.VAR_VALUE, 1, "<Value> := LETTERLITERAL"));

    }

    public Node startParse(){
        System.out.println(" ==================================================STARTING PARSER PHASE ==================================================");
        Stack<Node> stack = new Stack<Node>();
        Node root = new Node();
        stack.add(new Node(new Token(TokenTypes.DOLLAR), 0));



        Token currentInputToken = scan.ConsumeNextToken();
        boolean repeat = true;
        boolean endoftheline = false;

        while(repeat){
            int state = stack.peek().nodeState;
            int ordinal = currentInputToken.tokenType.ordinal();

            if(ordinal < 26){
                String action = parseTable[state][ordinal];

                if(action == ""){
                    System.out.println("==========ERROR IN THE PARSING==========");
                    System.out.println("CANNOT PARSE : " + currentInputToken.getTokenType());
                    System.out.println("State : " + state);
                    System.out.println("Ordinal : " + ordinal);
                    return null;
                }
                else if(action == "Accept"){
                    System.out.println("PROGRAM ACCEPTED");
                    return stack.pop();
                }

                switch(action.charAt(0)){
                    case 'S':
                        System.out.println("Action : " + action + " Shifting " + currentInputToken.getTokenType() + " with State " + action.substring(1));
                        //System.out.println(action.substring(1));
                        Node n = new Node(currentInputToken,Integer.parseInt(action.substring(1)));
                        stack.push(n);
                        currentInputToken = scan.ConsumeNextToken();


                        if (!Scanner.IsInputEnd()) {
                            System.out.println("END OF SCANNER REACHED");
                                endoftheline = true;
                                currentInputToken = new Token(TokenTypes.DOLLAR);
                        }

                        break;
                    case 'R':
                        ReductionRule rr = rules.get(action);
                        System.out.println("REDUCING BY " + action + " | " + rr.reductionGrammar);
                        Node m = new Node(new Token(rr.production), -1);

                        for(int i = 0; i< rr.popAmount; i++){
                            m.nodeChildren.addFirst(stack.pop());
                        }
                        System.out.println(rr.production + " ORDINAL " + rr.production.ordinal());
                        String newState = gotoTable[stack.peek().nodeState][rr.production.ordinal()-32];

                        if(newState == ""){
                            System.out.println("GOTO TABLE ERROR");
                            return null;
                        }
                        m.nodeState = Integer.parseInt(newState);
                        stack.push(m);

                        break;

                    default:
                        System.out.println("PARSING ERROR WEW LAD");
                        return null;
                }


            }
            else{
                currentInputToken = scan.ConsumeNextToken();
                if(!Scanner.IsInputEnd()){
                    repeat = false;
                }
            }
        }
        return root;
    }

    static Stack<Node> dfsStack = new Stack<Node>();
    static String treeVal = "";
    static int index = 0;

    public static String DepthFirstTraversal(Node parent){

        //System.out.println("DEPTH TOKEN: " + parent.nodeToken.getTokenType());
        treeVal += "[";
        treeVal += parent.nodeToken.getTokenType().toString() + " # ";

        if(!parent.nodeChildren.isEmpty()) {
            treeVal += "[";
            for (Node child : parent.nodeChildren) {
                DepthFirstTraversal(child);
                treeVal += ",";
            }
            treeVal += "]";
        }
        else{
            treeVal += "[]";
        }
        treeVal += "]";
        return treeVal;
    }

}
